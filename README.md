# Train Reports ETL

This project is a **report exporter for train data**, written in Python, that reads Excel reports and processes them to export to a PostgreSQL database.

The main script (`reports_exporter_v0.83.py`) automates reading and cleaning different types of reports generated by the train system (train list, occupancy, and payments), validates their content, detects corrupted or incorrect reports, and finally exports the clean and transformed data to database tables.

---

## Features

1. **Reads Excel files** with reports of:
   - Train List
   - Occupancy
   - Booking Payment Detailed  

2. **Identifies the report type** by comparing headers with expected structures.

3. **Cleans the data**, detects incorrect or incomplete records, and saves them in error files.

4. **Adds useful columns**, such as normalized departure times, unique keys, and operation dates.

5. **Can process large files in parallel** to improve reading performance.

6. **Exports the cleaned data to a PostgreSQL database** (AFC schema).

7. **Logs detailed information** and shows alerts if errors or warnings occur.

---

## Folder Structure

The resulting folder structure after the execution will be:
- data/                # Processed files moved here
- export/              # CSV files generated after export
- log/                 # Execution logs

---

## Limitations

- Only supports the three defined report types.
- Headers must match exactly the expected structure.
- Version validation prevents running the script if it is outdated compared to versions stored in the database.
